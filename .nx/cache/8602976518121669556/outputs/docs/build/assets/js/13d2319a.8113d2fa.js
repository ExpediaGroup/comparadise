"use strict";(self.webpackChunkdocs=self.webpackChunkdocs||[]).push([[617],{7200:(e,s,n)=>{n.r(s),n.d(s,{assets:()=>c,contentTitle:()=>o,default:()=>d,frontMatter:()=>i,metadata:()=>r,toc:()=>u});var t=n(5250),a=n(7160);const i={sidebar_position:4},o="Setting Up CI/CD",r={id:"setup/cicd",title:"Setting Up CI/CD",description:"Comparadise ships a GitHub Action that executes all steps necessary to run and evaluate your visual tests!",source:"@site/docs/setup/cicd.md",sourceDirName:"setup",slug:"/setup/cicd",permalink:"/comparadise/docs/setup/cicd",draft:!1,unlisted:!1,tags:[],version:"current",sidebarPosition:4,frontMatter:{sidebar_position:4},sidebar:"docsSidebar",previous:{title:"Deploying the Web App",permalink:"/comparadise/docs/setup/deploying-the-app"},next:{title:"Writing Visual Tests",permalink:"/comparadise/docs/setup/writing-visual-tests"}},c={},u=[{value:"Example Usage",id:"example-usage",level:2},{value:"Example Usage With Matrix Jobs",id:"example-usage-with-matrix-jobs",level:2}];function l(e){const s=Object.assign({h1:"h1",p:"p",ul:"ul",li:"li",code:"code",a:"a",strong:"strong",h2:"h2",pre:"pre"},(0,a.ah)(),e.components);return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(s.h1,{id:"setting-up-cicd",children:"Setting Up CI/CD"}),"\n",(0,t.jsx)(s.p,{children:"Comparadise ships a GitHub Action that executes all steps necessary to run and evaluate your visual tests!"}),"\n",(0,t.jsx)(s.p,{children:"This action will do the following:"}),"\n",(0,t.jsxs)(s.ul,{children:["\n",(0,t.jsx)(s.li,{children:"Downloads base images from your S3 bucket"}),"\n",(0,t.jsx)(s.li,{children:"Runs your visual tests"}),"\n",(0,t.jsx)(s.li,{children:'Checks for "diff" and "new" base images'}),"\n",(0,t.jsx)(s.li,{children:'Conditionally uploads "diff" and "new" images to your S3 bucket'}),"\n",(0,t.jsx)(s.li,{children:"Conditionally leaves a PR comment with a Comparadise link"}),"\n",(0,t.jsx)(s.li,{children:"Sets the appropriate Visual Regression commit status on the PR"}),"\n"]}),"\n",(0,t.jsx)(s.p,{children:"Therefore, your visual test workflow must check out your repo, install dependencies to run your visual tests, and obtain AWS credentials prior to running the Comparadise action."}),"\n",(0,t.jsxs)(s.p,{children:["Make sure to also set the ",(0,t.jsx)(s.code,{children:"Visual Regression"})," status as required in a ",(0,t.jsx)(s.a,{href:"https://docs.github.com/en/repositories/configuring-branches-and-merges-in-your-repository/managing-protected-branches/managing-a-branch-protection-rule",children:"branch protection"})," rule for your repo."]}),"\n",(0,t.jsxs)(s.p,{children:[(0,t.jsx)(s.strong,{children:"Note:"}),' It is recommended to name your jobs something like "Take Screenshots" to avoid confusion with the required ',(0,t.jsx)(s.code,{children:"Visual Regression"})," status that Comparadise sets."]}),"\n",(0,t.jsx)(s.h2,{id:"example-usage",children:"Example Usage"}),"\n",(0,t.jsx)(s.pre,{children:(0,t.jsx)(s.code,{className:"language-yaml",children:"on:\n  pull_request:\n    branches:\n      - main\n\njobs:\n  visual-tests:\n    name: Take Screenshots\n    runs-on: ubuntu-latest\n    steps:\n      - uses: actions/checkout@v3\n\n      - run: npm install\n\n      # Some AWS authentication step here\n\n      - name: Take Screenshots\n        uses: ExpediaGroup/comparadise@v1\n        with:\n          visual-test-command: npm run visual-tests\n          bucket-name: visual-regression-bucket\n          commit-hash: ${{ github.event.pull_request.head.sha }}\n          comparadise-host: https://my-comparadise-url.com\n"})}),"\n",(0,t.jsx)(s.h2,{id:"example-usage-with-matrix-jobs",children:"Example Usage With Matrix Jobs"}),"\n",(0,t.jsx)(s.pre,{children:(0,t.jsx)(s.code,{className:"language-yaml",children:"on:\n  pull_request:\n    branches:\n      - main\n\njobs:\n  visual-tests:\n    name: Take Screenshots (${{ matrix.name }})\n    strategy:\n      fail-fast: false\n      matrix:\n        include:\n          - name: Test 1\n            spec: '**/test-1.cy.ts'\n          - name: Test 2\n            spec: '**/test-2.cy.ts'\n    runs-on: ubuntu-latest\n    steps:\n      - uses: actions/checkout@v3\n\n      - run: npm install\n\n      # Some AWS authentication step here\n\n      - name: Run Visual Tests\n        uses: ExpediaGroup/comparadise@v1\n        with:\n          visual-test-command: npm run visual-tests --spec=\"${{ matrix.spec }}\"\n          bucket-name: visual-regression-bucket\n          commit-hash: ${{ github.event.pull_request.head.sha }}\n          comparadise-host: https://my-comparadise-url.com\n"})})]})}const d=function(e={}){const{wrapper:s}=Object.assign({},(0,a.ah)(),e.components);return s?(0,t.jsx)(s,Object.assign({},e,{children:(0,t.jsx)(l,e)})):l(e)}},7160:(e,s,n)=>{n.d(s,{Zo:()=>r,ah:()=>i});var t=n(79);const a=t.createContext({});function i(e){const s=t.useContext(a);return t.useMemo((()=>"function"==typeof e?e(s):{...s,...e}),[s,e])}const o={};function r({components:e,children:s,disableParentContext:n}){let r;return r=n?"function"==typeof e?e({}):e||o:i(e),t.createElement(a.Provider,{value:r},s)}}}]);